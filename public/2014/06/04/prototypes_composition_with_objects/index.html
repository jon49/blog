<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Prototypes &amp; Compositions with Objects</title>
  <meta name="description" content="">
  <meta name="author" content="Jon Nyman">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>@import url("//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css");
body{background-color:#c2dfff;font-family:sans-serif;color:#36465d;}body > *{margin:0 auto;width:100%}a{color:#86555c;}a:visited{color:#36465d}nav,.archive,.footer-menu,.nav-posts{text-align:center;font-size:16px;line-height:24px;}nav ul,.archive ul,.footer-menu ul,.nav-posts ul{padding:0}nav li,.archive li,.footer-menu li,.nav-posts li{list-style-type:none}nav a,.archive a,.footer-menu a,.nav-posts a{text-decoration:none;color:#36465d;padding:15px}nav a:hover,.archive a:hover,.footer-menu a:hover,.nav-posts a:hover{color:#c2dfff;background-color:#83a4d2}.posts a{padding-top:3px;padding-bottom:3px;display:block}.nav-posts{margin-top:15px;font-weight:bold;}.nav-posts .next::before{content:'«'}.nav-posts .previous::after{content:' »'}.nav-posts a{text-decoration:none}nav li,.footer-menu li{display:inline-block}h1{border-bottom:solid #36465d 1px;padding:10px;font-size:32px}footer{font-size:12px;text-align:center}@media screen and (min-width:801px){.site-logo{background-color:transparent;background-image:url("/images/fire.png");display:block;width:80px;height:80px;margin:0 auto;border:solid #36465d 2px;border-radius:50%}body > *{width:800px}}.hljs-variable,.hljs-attribute,.hljs-tag,.hljs-regexp,.hljs-name,.ruby .hljs-constant,.xml .hljs-tag .hljs-title,.xml .hljs-pi,.xml .hljs-doctype,.html .hljs-doctype,.css .hljs-id,.css .hljs-class,.css .hljs-pseudo{color:#86555c}.hljs-number,.hljs-preprocessor,.hljs-built_in,.hljs-literal,.hljs-params,.hljs-constant{color:#987f5a}.ruby .hljs-class .hljs-title,.css .hljs-rule .hljs-attribute{color:#a49a59}.hljs-string,.hljs-value,.hljs-inheritance,.hljs-header,.ruby .hljs-symbol,.xml .hljs-cdata{color:#7d9726}.hljs-title,.css .hljs-hexcolor{color:#5b9d48}.hljs-function,.python .hljs-decorator,.python .hljs-title,.ruby .hljs-function .hljs-title,.ruby .hljs-title .hljs-keyword,.perl .hljs-sub,.javascript .hljs-title,.coffeescript .hljs-title{color:#83a4d2}.hljs-keyword,.javascript .hljs-function{color:#5f9182}.diff .hljs-deletion,.diff .hljs-addition{color:#22221b;display:inline-block;width:100%}.diff .hljs-deletion{background-color:#ba6236}.diff .hljs-addition{background-color:#7d9726}.diff .hljs-change{color:#36a166}.hljs{display:block;overflow-x:auto;background:#36465d;color:#c2dfff;padding:.5em;-webkit-text-size-adjust:none}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .javascript,.xml .vbscript,.xml .css,.xml .hljs-cdata{opacity:.5}</style>
</head>
<body>

<nav>
  <ul>
    <li>
      <a href="/">Archive</a>
    </li>
    <li>
      <a href="/about/">About</a>
    </li>
  </ul>
</nav>

<header>
  <a href="/" class="site-logo"></a>
</header>


<h1>Prototypes &amp; Compositions with Objects</h1>
<article>
  <p>I was trying to figure out the best way to have functions be both compatible with an object oriented paradigm and a functional oriented paradigm when working on objects. My implementations are probably naive, but instructive nevertheless. It seems that <a href="http://lodash.com/">lo-dash</a> and other libraries have done a good job bridging those worlds.</p>

<p>Let&rsquo;s say you have an object <code>O</code> such that</p>

<pre><code class="language-javascript">function O(a, b){
  this.a = a
  this.b = b
}

var o = function(a, b){
  return new O(a, b)
}
</code></pre>

<p>Now, you want to <code>extend</code> the object but you also want the option to use the object in a more fuctional way with <code>compose</code>.</p>

<p>Let&rsquo;s start with a simple <code>display</code> method.</p>

<pre><code class="language-javascript">var display = function(thisArg){
  var o_ = thisArg || this
  console.log(o_)
  return o_
}
</code></pre>

<p>Then a method to change a property.*</p>

<pre><code class="language-javascript">var change = function(property){
  return function(value, thisArg){
  	var o_ = _.cloneDeep(thisArg || this)
    o_[property] = value
    return o_
  }
}
</code></pre>

<p>Now we can set property to:</p>

<pre><code class="language-javascript">var changeA = change('a')
</code></pre>

<p>Then we can add <code>changeA</code> to the <code>O</code> object and use it.</p>

<pre><code class="language-javascript">O.prototype.changeA = changeA
var o_ = o(1, 2)
o_.changeA(3).display()
</code></pre>

<p>Or we can use a functional approach.</p>

<pre><code class="language-javascript">var o_ = o(1, 2)
_.compose(display, _.curry(changeA)(3))(o_)
//OR
_.compose(display, _.partialRight(changeA, o_))(3)
//OR
_.compose(display, changeA)(3, o_)
</code></pre>

<p>I think I like the functional approach for the more abstract functions and the OO approach as your code becomes more specific. The functional evangelists say the functional style is better because it leads to more reusable code. Which I would agree with, since you are not tying your code up with an object you can then easily extend your model to various other objects, without the use of <code>inheritance</code> and other OO monsters. I think I will use a hybrid approach with <code>bilby.js</code> library which uses polymorphism.</p>

<p>By the way, what I just did with <code>change</code> is similar to <a href="https://github.com/fantasyland/fantasy-lenses"><code>lenses</code></a>.</p>

<p>* An alternative to this would be using a partial function, which would make the original function more flexible.</p>

<pre><code class="language-javascript">var change = function(property, value, thisArg){
  	var o_ = _.cloneDeep(thisArg || this)
    o_[property] = value
    return o_
  }
}
</code></pre>

<p>Now we can set property to:</p>

<pre><code class="language-javascript">var changeA = _.partial(change, 'a')
</code></pre>

<p>Or using combinators (not strict).</p>

<pre><code class="language-javascript">var set = function(property, value){
  this[property] = value
  return this
}

var change = function(f, value, thisArg){
  	var o_ = _.cloneDeep(thisArg || this)
    o_ = f.apply(o_, [value])
    return o_
  }
}
</code></pre>

<p>Now we can set property to:</p>

<pre><code class="language-javascript">var changeA = _.partial(change
              , _.partial(set, 'a'))
</code></pre>

</article>
<p>
<span>Wed Jun 4, 2014</span>
   | 

  
    tags:
      <a href="/tags/functional-programming">functional programming</a>
    
      <a href="/tags/design-patterns">design patterns</a>
    
      <a href="/tags/lenses">lenses</a>
    
  

  

  

</p>


<div class="nav-posts">
  
    <a class="next" href="http://localhost:1313/2014/05/29/functional_immutability_in_javascript/"> Functional Immutability in JavaScript</a>
  

  
    
      
      ✴
      
      <a class="previous" href="http://localhost:1313/2014/06/07/html/"> JavaScript</a>
    
  
</div>


<div class="footer-menu">
  <ul>

    <li>
      <a class=" fa fa-rss fa-2x" href="/index.xml" title="RSS Feed"></a>
    </li>

    <li>
      <a class=" fa fa-github fa-2x" href="https://github.com/jon49/" title="Personal Github Account"></a>
    </li>

    <li>
      <a class=" fa fa-twitter fa-2x" href="https://twitter.com/NymanJon" title="Personal Twitter Account"></a>
    </li>

  </ul>
</div>

<footer>
  <p>
  © 2015 Jon Nyman
    <br>
    nymanjon@gmail.com
    <br>
    Hamsters Byte
  </p>
</footer>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>


<script src="/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
