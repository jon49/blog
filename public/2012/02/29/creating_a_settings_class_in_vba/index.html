<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Creating a Settings Class in VBA</title>
  <meta name="description" content="">
  <meta name="author" content="Jon Nyman">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>@import url("//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css");
body{background-color:#c2dfff;font-family:sans-serif;color:#36465d;}body > *{margin:0 auto;width:100%}a{color:#86555c;}a:visited{color:#36465d}nav,.archive,.footer-menu,.nav-posts{text-align:center;font-size:16px;line-height:24px;}nav ul,.archive ul,.footer-menu ul,.nav-posts ul{padding:0}nav li,.archive li,.footer-menu li,.nav-posts li{list-style-type:none}nav a,.archive a,.footer-menu a,.nav-posts a{text-decoration:none;color:#36465d;padding:15px}nav a:hover,.archive a:hover,.footer-menu a:hover,.nav-posts a:hover{color:#c2dfff;background-color:#83a4d2}.posts a{padding-top:3px;padding-bottom:3px;display:block}.nav-posts{margin-top:15px;font-weight:bold;}.nav-posts .next::before{content:'«'}.nav-posts .previous::after{content:' »'}.nav-posts a{text-decoration:none}nav li,.footer-menu li{display:inline-block}h1{border-bottom:solid #36465d 1px;padding:10px;font-size:32px}footer{font-size:12px;text-align:center}@media screen and (min-width:801px){.site-logo{background-color:transparent;background-image:url("/images/fire.png");display:block;width:80px;height:80px;margin:0 auto;border:solid #36465d 2px;border-radius:50%}body > *{width:800px}}.hljs-variable,.hljs-attribute,.hljs-tag,.hljs-regexp,.hljs-name,.ruby .hljs-constant,.xml .hljs-tag .hljs-title,.xml .hljs-pi,.xml .hljs-doctype,.html .hljs-doctype,.css .hljs-id,.css .hljs-class,.css .hljs-pseudo{color:#86555c}.hljs-number,.hljs-preprocessor,.hljs-built_in,.hljs-literal,.hljs-params,.hljs-constant{color:#987f5a}.ruby .hljs-class .hljs-title,.css .hljs-rule .hljs-attribute{color:#a49a59}.hljs-string,.hljs-value,.hljs-inheritance,.hljs-header,.ruby .hljs-symbol,.xml .hljs-cdata{color:#7d9726}.hljs-title,.css .hljs-hexcolor{color:#5b9d48}.hljs-function,.python .hljs-decorator,.python .hljs-title,.ruby .hljs-function .hljs-title,.ruby .hljs-title .hljs-keyword,.perl .hljs-sub,.javascript .hljs-title,.coffeescript .hljs-title{color:#83a4d2}.hljs-keyword,.javascript .hljs-function{color:#5f9182}.diff .hljs-deletion,.diff .hljs-addition{color:#22221b;display:inline-block;width:100%}.diff .hljs-deletion{background-color:#ba6236}.diff .hljs-addition{background-color:#7d9726}.diff .hljs-change{color:#36a166}.hljs{display:block;overflow-x:auto;background:#36465d;color:#c2dfff;padding:.5em;-webkit-text-size-adjust:none}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .javascript,.xml .vbscript,.xml .css,.xml .hljs-cdata{opacity:.5}</style>
</head>
<body>

<nav>
  <ul>
    <li>
      <a href="/">Archive</a>
    </li>
    <li>
      <a href="/about/">About</a>
    </li>
  </ul>
</nav>

<header>
  <a href="/" class="site-logo"></a>
</header>


<h1>Creating a Settings Class in VBA</h1>
<article>
  <p>In .NET they have a nice settings class you can create using <a href="http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.aspx">ApplicationSettingsBase base class</a>. In VBA it takes a bit more work to get it working, but can be fairly elegant if done correctly.</p>

<p>Some criteria that is needed for a settings class in vba are:
<ul>
    <li>Well formed</li>
    <li>Fast lookup</li>
    <li>Default setting</li>
    <li>Single input/output procedures.</li>
</ul>
To make it well formed I used an <a href="http://www.cpearson.com/excel/Enums.aspx">enumeration variable type</a> to create each setting. I think string constants could accomplish the same thing.</p>

<p>To have a fast look up I use the <a href="http://support.microsoft.com/kb/187234">dictionary object</a>  which<a href="http://www.dotnetperls.com/dictionary-vbnet"> can look up values much faster than</a> the <a href="http://support.microsoft.com/kb/198465">collection object</a>.</p>

<p>Doing default settings is interesting. It took me some time to figure out how to do that. But all that is needed is an optional boolean value for the Get and Let procedures.</p>

<p>A single point to output your values to makes it easy to trouble shoot if something isn&rsquo;t working correctly. Also, the single input is just one procedure that grabs data from where ever you choose to store it and if it isn&rsquo;t stored then it will just grabs the default value.</p>

<p>Here&rsquo;s an example on how a property would look like:</p>

<pre><code class="language-vbscript">'In order to get default value an optional field is needed in the Get and Let procedures.
Public Property Get _
    Example(Optional ByVal bReturnDefault As Boolean = False) _
    As Double
    
    'Uses dictionary for look up of value (loads dictionary when creating new settings class.
    'SettingNames is the enumeration type.
    If mdicSettings.Exists(SettingNames.Example) _
        And Not bReturnDefault Then
    
        Example = CDbl(mdicSettings(SettingNames.Example))
    Else
        Example = 10
    End If
End Property

Public Property Let _
    Example(Optional ByVal bReturnDefault As Boolean = False _
    , ByVal dValue As Double)
    
    'Single point write (all values stored as string).
    'Note that the key is just the integer from the enumeration.
    AddSetting SettingNames.Example, CStr(dValue)
End Property
</code></pre>

</article>
<p>
<span>Wed Feb 29, 2012</span>
   | 

  
    tags:
      <a href="/tags/vba">vba</a>
    
      <a href="/tags/settings">settings</a>
    
  

  

  

</p>


<div class="nav-posts">
  
    <a class="next" href="http://jnyman.com/2012/02/15/advancedfilter_class_part_2_determining_what_options_we_want/"> AdvancedFilter Class Part 2</a>
  

  
    
      
      ✴
      
      <a class="previous" href="http://jnyman.com/2012/03/02/advancedfilter_class_part_3_creating_the_sub_class/"> AdvancedFilter Class Part 3</a>
    
  
</div>


<div class="footer-menu">
  <ul>

    <li>
      <a class=" fa fa-rss fa-2x" href="/index.xml" title="RSS Feed"></a>
    </li>

    <li>
      <a class=" fa fa-github fa-2x" href="https://github.com/jon49/" title="Personal Github Account"></a>
    </li>

    <li>
      <a class=" fa fa-twitter fa-2x" href="https://twitter.com/NymanJon" title="Personal Twitter Account"></a>
    </li>

  </ul>
</div>

<footer>
  <p>
  © 2016 Jon Nyman
    <br>
    nymanjon@gmail.com
    <br>
    Hamsters Byte
  </p>
</footer>

</body>
</html>


<script src="/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
