<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Hamsters Byte</title>
    <link>http://localhost:1313/post/</link>
    <description>Recent content in Posts on Hamsters Byte</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 12 Feb 2017 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/post/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>The Power of Static Typing</title>
      <link>http://localhost:1313/2017/02/12/the_power_of_static_typing/</link>
      <pubDate>Sun, 12 Feb 2017 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2017/02/12/the_power_of_static_typing/</guid>
      <description>&lt;p&gt;From what I understand &lt;a href=&#34;http://www.cs.cmu.edu/~NatProg/papers/CHI2016-SIG-ProgLang-Usability.pdf&#34;&gt;static typing makes programmers more productive and
gives implicit documentation to the code
base&lt;/a&gt;
- although explicit documentation is also very helpful.  It also seems to make
the tools we use much more powerful.&lt;/p&gt;

&lt;p&gt;One of the problems of static typing is that your code becomes more verbose.
With programming languages like F# the compiler will implicitly type as much
of your program as possible. Where it fails, you need to type it yourself.&lt;/p&gt;

&lt;p&gt;Not only that but many times static languages will provide tools to do the
typing for you. F# has &lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/articles/fsharp/tutorials/type-providers/&#34;&gt;Type
Providers&lt;/a&gt;
which will dynamically create types for your program on the fly, lessening the
burdens of a statically typed system. One of my favorite libraries that does
this is &lt;a href=&#34;http://fsprojects.github.io/FSharp.Data.SqlClient/&#34;&gt;&lt;code&gt;FSharp.Data.SqlClient&lt;/code&gt; - &lt;em&gt;Not your grandfather&amp;rsquo;s
ORM&lt;/em&gt;&lt;/a&gt; which will
statically type your calls to SQL Server letting you even type raw SQL in your
code. Another useful one is the &lt;a href=&#34;http://fsharp.github.io/FSharp.Data/library/JsonProvider.html&#34;&gt;JSON Type
Provider&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;With F#, &lt;a href=&#34;http://websharper.com/&#34;&gt;WebSharper&lt;/a&gt;, and &lt;a href=&#34;https://msdn.microsoft.com/en-us/library/hh272686%28v=vs.103%29.aspx&#34;&gt;SQL Server Data
Tools&lt;/a&gt;(SSDT)
you can have static typing from your database all the way down to your client
web app. You can literally keep everything in sync with each other from across
your entire infrastructure. This seems really huge to me. Programming in any
other way seems like programming in the past, by decades. Unfortunately, it
seems like it takes ages for the programming community and business industry
to get on board. It is understandable and mind boggling at the same time.&lt;/p&gt;

&lt;p&gt;So, SSDT, can give you static typing across databases, it seems to work best
when they live on the same server when you track the databases in the same
SSDT solution. But you can also have this static typing across different
servers in different SSDT solutions by referencing the &lt;code&gt;dacpac&lt;/code&gt; of the
different databases you are connecting to. It also makes testing much simpler
with the help of &lt;a href=&#34;http://tsqlt.org/&#34;&gt;&lt;code&gt;tSQLt&lt;/code&gt;&lt;/a&gt; testing framework.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve never used &lt;a href=&#34;http://websharper.com/&#34;&gt;WebSharper&lt;/a&gt; before but it looks like
it is a wonderful way to write your back end and front end code. I&amp;rsquo;m not sure
if other .NET frameworks can give you the same static typing that WebSharper
can, but &lt;a href=&#34;http://websharper.com/blog-entry/5204/distributed-web-applications-in-f-with-websharper&#34;&gt;WebSharper can generate your end points for you in distributed
applications, letting them be private or public end
points&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;So, with all this incredible technology that can make us so much more
productive why do we not embrace this technology and stop doing the computer&amp;rsquo;s
work for it? I&amp;rsquo;m sure there are many reasons, including psychology and
business maintainability. Which I won&amp;rsquo;t enumerate some here, which I
think could possibly be reasons. Let&amp;rsquo;s start embracing this technology and
start slowly introducing them where we can in are work places. It might take
another ten or twenty years to be able to really start letting the computer do
its work rather than us doing its work, but the time to start planting the
seeds is now.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Authentication and Authorization in ASP.NET Core</title>
      <link>http://localhost:1313/2017/01/29/authentication_in_asp_net_core/</link>
      <pubDate>Sun, 29 Jan 2017 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2017/01/29/authentication_in_asp_net_core/</guid>
      <description>&lt;p&gt;One thing that really got me frustrated in WebAPI 2.0 was creating custom
authentication. Eventually I found a &lt;a href=&#34;https://weblog.west-wind.com/posts/2013/Apr/18/A-WebAPI-Basic-Authentication-Authorization-Filter&#34;&gt;blog post by Rick
Strahl&lt;/a&gt;
that showed how to roll your own authentication/authorization. I wanted to
implement a login (&lt;a href=&#34;https://en.wikipedia.org/wiki/Basic_access_authentication&#34;&gt;Basic
Authentication&lt;/a&gt;)
with username/password that would return a token for later (&lt;a href=&#34;https://en.wikipedia.org/wiki/OAuth&#34;&gt;Bearer
Authorization&lt;/a&gt;) use. It was quite simple
but really frustrating because there wasn&amp;rsquo;t a whole lot of documentation on
the subject.&lt;/p&gt;

&lt;p&gt;Now I want to do something similar for ASP.NET Core. But there wasn&amp;rsquo;t any
documentation on that either. For ASP.NET Core I wanted to implement an OAuth
2.0 with a custom provider. But there isn&amp;rsquo;t any documentation on the subject.
I&amp;rsquo;ve struggling to find a solution to it I ran across a couple of &lt;a href=&#34;http://stackoverflow.com/&#34;&gt;Stack
Overflow&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The first one that I found really easy to follow is here
&lt;a href=&#34;http://stackoverflow.com/questions/37396709/simple-token-based-authentication-authorization-in-asp-net-core-for-mongodb-data/37415902#37415902&#34;&gt;http://stackoverflow.com/questions/37396709/simple-token-based-authentication-authorization-in-asp-net-core-for-mongodb-data/37415902#37415902&lt;/a&gt;.
The second one is here
&lt;a href=&#34;http://stackoverflow.com/questions/31687955/authorizing-a-user-depending-on-the-action-name/31688792#31688792&#34;&gt;http://stackoverflow.com/questions/31687955/authorizing-a-user-depending-on-the-action-name/31688792#31688792&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Both of them together give a good overview of how one can create custom
authentication/authorization. One thing to note is that a &lt;code&gt;Claim&lt;/code&gt; can have the
first parameter be a simple &lt;code&gt;string&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>F# with Web API and Railway-Oriented Programming</title>
      <link>http://localhost:1313/2016/12/04/fsharp_with_webapi/</link>
      <pubDate>Sun, 04 Dec 2016 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/12/04/fsharp_with_webapi/</guid>
      <description>

&lt;p&gt;I presented at the &lt;a href=&#34;http://oct2016.desertcodecamp.com/session/1224&#34;&gt;2016 Desert Code
Camp&lt;/a&gt;. The topic was &lt;em&gt;WebAPI
with F#&lt;/em&gt;. I also did a video series to go along with the talk. The talk and
video series basically goes over how to use F# in a functional manner by
building out all the pieces from scratch.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s the series, hope you enjoy it!&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/playlist?list=PLBrr7-AbuzAfeA4vVhHEDsaAPBep2SUVI&#34;&gt;F# WebAPI From Start to
Finish&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Some set up steps and notes that are important to the success of the project:&lt;/p&gt;

&lt;p&gt;Rather than using a custom Railway-Oriented code like in the videos you can use
&lt;a href=&#34;https://fsprojects.github.io/Chessie/railway.html&#34;&gt;Chessie&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://jnyman.com/2016/11/27/validation_in_fsharp/&#34;&gt;I&amp;rsquo;ve updated my validation library.&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;setting-up-your-project:b907d02c7024fd468e4e916e6de9753a&#34;&gt;Setting Up Your Project&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://visualstudiogallery.msdn.microsoft.com/136b942e-9f2c-4c0b-8bac-86d774189cff&#34;&gt;Install Visual F# Power Tools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Create new C# WebAPI&lt;/li&gt;
&lt;li&gt;Create new F# Library&lt;/li&gt;
&lt;li&gt;Add reference to F# Library from C# project.&lt;/li&gt;
&lt;li&gt;Make sure works&lt;/li&gt;
&lt;li&gt;Add reference to System.Net.Http&lt;/li&gt;
&lt;li&gt;Add reference to System.Web.Http &amp;rarr; Need to install Nuget package
Microsoft.AspNet.WebApi.Core&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.ploeh.dk/2015/03/19/posting-json-to-an-f-web-api/&#34;&gt;Add configuration&lt;/a&gt;
&amp;rarr;
&lt;code&gt;GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ContractResolver = new Newtonsoft.Json.Serialization.CamelCasePropertyNamesContractResolver();&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/eulerfx/JsonNet.FSharp&#34;&gt;Add FSharp Converters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Configuration

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://fsharp.github.io/FSharp.Data/library/JsonProvider.html&#34;&gt;JsonProvider&lt;/a&gt;
&amp;rarr; Use FSharp.Data from Nuget&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Connecting to a database using
&lt;a href=&#34;http://fsprojects.github.io/FSharp.Data.SqlClient/&#34;&gt;FSharp.Data.SqlClient&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;resources-for-railway-oriented-programming:b907d02c7024fd468e4e916e6de9753a&#34;&gt;Resources for Railway-Oriented Programming&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://fsharpforfunandprofit.com/rop/&#34;&gt;https://fsharpforfunandprofit.com/rop/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://fsharpforfunandprofit.com/posts/recipe-part2/&#34;&gt;https://fsharpforfunandprofit.com/posts/recipe-part2/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Validation in F#</title>
      <link>http://localhost:1313/2016/11/27/validation_in_fsharp/</link>
      <pubDate>Sun, 27 Nov 2016 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/11/27/validation_in_fsharp/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://gist.github.com/jon49/c2835a9c85b43036323547dc3706ebd2&#34;&gt;The full code for this article is up on GitHub.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I like to the keep things as simple as possible and, ideally, reusable. At my
previous employment I came up with a method of validation, but I was never
entirely happy with the results. Some of the code repeated itself, and it was
difficult to extend to arrays and array comparison. So, I went back to the
drawing board building on top of the ideas that I created with the first
validation library I created.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s how the original API looked:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;validate &amp;quot;Name&amp;quot; a.Name [nonEmptyString]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So, you needed to add the name of your property, the property, and a list of
validators you would like to validate. The list of validators would return a
&lt;code&gt;Choice&amp;lt;string, &#39;a&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The new validation has a pretty straight forward API that is used throughout.
You can validate against an &lt;code&gt;Object&lt;/code&gt;, &lt;code&gt;Array&lt;/code&gt;, &lt;code&gt;Primitive&lt;/code&gt;, or &lt;code&gt;Raw&lt;/code&gt; value.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;Object&lt;/code&gt; validation validates against each property in a &lt;code&gt;Record&lt;/code&gt;. If one
fails then it will continue to validate the other properties also. But if
there are multiple validators on a single property the first failure will
return but not the others. &lt;code&gt;Object&lt;/code&gt; has the following signature:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;| Object of
    value : Expr&amp;lt;&#39;a&amp;gt; *
    required : bool *
    proof : (&#39;a -&amp;gt; (string list option) list)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Where &lt;code&gt;value&lt;/code&gt; is the quotation value of the property you are testing.
&lt;code&gt;required&lt;/code&gt; tests if the property is &lt;code&gt;null&lt;/code&gt; or not if you mark it as true,
otherwise it doesn&amp;rsquo;t care if it is &lt;code&gt;null&lt;/code&gt; or not. &lt;code&gt;proof&lt;/code&gt; is the list of
provided validators. A single validator has the signature
&lt;code&gt;a -&amp;gt; string option&lt;/code&gt;. If the property is valid the validator returns &lt;code&gt;None&lt;/code&gt;
otherwise it returns &lt;code&gt;Some&lt;/code&gt; with a message describing why it didn&amp;rsquo;t pass
validation.&lt;/p&gt;

&lt;p&gt;I like this way of validating since it keeps things simple. The validators are
reusable functions which return a simple &lt;code&gt;string option&lt;/code&gt;. The validators are
composable functions that can be put in a list. The discriminated union
validation object is also composable.&lt;/p&gt;

&lt;p&gt;Some things that I don&amp;rsquo;t like about validating this way. There is no compile
time check to determine if you validated each field in an object. For that
matter there is no runtime test for that either. It would be nice to have a
least a runtime way to tell if all properties were tested, or, even better, a
compile time way. But this works for now.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s an example of using all the validators in with an object.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;type Person =
    {
    Name : Name
    BirthDate : DateTime
    Favorites : string[]
    FavoriteNumbers : int[]
    }
    static member Proof a =
                [
                prove &amp;lt;| Primitive (&amp;lt;@ a.BirthDate @&amp;gt;, true, [])
                prove &amp;lt;| Object (&amp;lt;@ a.Name @&amp;gt;, true, Name.Proof)
                prove &amp;lt;|
                    Array (
                        &amp;lt;@ a.Favorites @&amp;gt;,
                        true,
                        [arrayMinLength 1],
                        (fun favorite -&amp;gt; Primitive (&amp;lt;@ favorite @&amp;gt;, true, [stringMax 5]) ))
                prove &amp;lt;|
                    Array (
                        &amp;lt;@ a.FavoriteNumbers @&amp;gt;,
                        true,
                        [arrayMinLength 1],
                        fun favorite -&amp;gt; Primitive (&amp;lt;@ favorite @&amp;gt;, true, [greaterThan 2])
                    )
                prove &amp;lt;|
                    Raw (
                        (a.Favorites, a.FavoriteNumbers),
                        &amp;quot;Person.Favorites, Person.FavoriteNumbers&amp;quot;,
                        [
                        fun (a, b) -&amp;gt;
                            match a, b with
                            | null, null | null, _ | _, null -&amp;gt; Some &amp;quot;Arrays must not be null.&amp;quot;
                            | _ -&amp;gt; None
                        fun (a, b) -&amp;gt;
                            if a.Length = b.Length then
                                None
                            else
                                Some &amp;lt;| sprintf &amp;quot;Arrays must have same length but Person.Favorites has %i and Person.FavoriteNumbers has %i&amp;quot; a.Length b.Length
                        ]
                    )
                ]
    static member Validate a =
        prove &amp;lt;| Object (&amp;lt;@ a @&amp;gt;, true, Person.Proof)

let jon = {
    Name = { First = &amp;quot;Jon&amp;quot;; Last = &amp;quot;Nyman1&amp;quot; }
    BirthDate = new DateTime(1947, 9, 9)
    Favorites = [| &amp;quot;Reading&amp;quot;; &amp;quot;Red&amp;quot;;  &amp;quot;Writing&amp;quot; |]
    FavoriteNumbers = [| 1 |]
    }

jon
|&amp;gt; validate Person.Validate
// |&amp;gt; ....

// OR
jon
|&amp;gt; validate (fun a -&amp;gt; prove &amp;lt;| Object (&amp;lt;@ a @&amp;gt;, true, Person.Proof))

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where &lt;code&gt;prove&lt;/code&gt; is&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;let rec prove validation =
    match validation with
    | Primitive (v, required, fs) -&amp;gt;
        match required, getValue v with
        | true, None -&amp;gt; Some [sprintf &amp;quot;The value `%s` is required but was found to be `null`.&amp;quot; v.Type.Name]
        | false, None -&amp;gt; None
        | _, Some value -&amp;gt;
            fs
            |&amp;gt; List.fold (fun acc f -&amp;gt;
                match acc with
                | None -&amp;gt; f value
                | Some _ -&amp;gt; acc
                ) None
            |&amp;gt; Option.map (fun x -&amp;gt; [printParameterWith &amp;quot; - &amp;quot; v + x] )
    | Object (v, required, f) -&amp;gt;
        match required, getValue v with
        | true, None -&amp;gt; Some [sprintf &amp;quot;The object `%s` is required but was found to be `null`.&amp;quot; (getOrElse &amp;quot;Unknown Parameter&amp;quot; &amp;lt;| getParameterName v)]
        | false, None -&amp;gt; None
        | _, Some x -&amp;gt;
            f x
            |&amp;gt; List.fold (
                fun acc option -&amp;gt;
                match option, acc with
                | Some newError, Some error -&amp;gt; Some (List.append error newError)
                | Some newError, None -&amp;gt; Some newError
                | None, Some error -&amp;gt; Some error
                | None, None -&amp;gt; None
                ) None
    | Array (vs, required, proof, proveItems) -&amp;gt; 
        match required, getValue vs with
        | true, None -&amp;gt; Some [sprintf &amp;quot;%s: %s&amp;quot; (getOrElse &amp;quot;Unknown Parameter&amp;quot; &amp;lt;| getParameterName vs) &amp;quot;This array is required.&amp;quot;]
        | false, None -&amp;gt; None
        | _, Some xs -&amp;gt;
            let validSelf =
                proof
                |&amp;gt; List.fold (fun acc f -&amp;gt;
                    match acc with
                    | None -&amp;gt; f xs
                    | Some _ -&amp;gt; acc
                ) None
            match validSelf, obj.Equals(vs, null) with
            | Some error, _ -&amp;gt; 
                Some [(printParameterWith &amp;quot;: &amp;quot; vs) + error]
            | _, true -&amp;gt;
                None
            | None, false -&amp;gt;
                xs
                |&amp;gt; Array.fold (fun (i, acc) x -&amp;gt;
                    let i = i + 1
                    match (prove (proveItems x) ), acc with
                    | Some newError, Some error -&amp;gt; 
                        (i, Some &amp;lt;| List.append error [prettyIndex i newError])
                    | Some newError, None -&amp;gt; (i, Some [prettyIndex i newError])
                    | None, Some error -&amp;gt; (i, Some error)
                    | None, None -&amp;gt; (i, None)
                ) (-1, None)
                |&amp;gt; snd
                |&amp;gt; Option.map (fun xs -&amp;gt; (printParameterWith &amp;quot;:&amp;quot; vs)::xs)
    | Raw (a, msg, fs) -&amp;gt;
        fs
        |&amp;gt; List.fold (fun acc f -&amp;gt;
            match acc with
            | None -&amp;gt; f a
            | Some _ -&amp;gt; acc
            ) None
        |&amp;gt; Option.map (fun x -&amp;gt; [msg+&amp;quot; - &amp;quot;+x] )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And &lt;code&gt;validate&lt;/code&gt; is:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;let validate f a =
    match f a with
    | Some xs -&amp;gt; Choice1Of2 &amp;lt;| String.concat &amp;quot;\n&amp;quot; xs
    | None -&amp;gt; Choice2Of2 a
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And &lt;code&gt;Validate&lt;/code&gt; is:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;type Validate&amp;lt;&#39;a&amp;gt; =
    | Object of
        value : Expr&amp;lt;&#39;a&amp;gt; *
        required : bool *
        proof : (&#39;a -&amp;gt; (string list option) list)
    | Array of
        value : Expr&amp;lt;&#39;a[]&amp;gt; *
        required : bool *
        proof : (&#39;a[] -&amp;gt; string Option) list *
        proveItems : (&#39;a -&amp;gt; Validate&amp;lt;&#39;a&amp;gt;)
    | Primitive of
        value : Expr&amp;lt;&#39;a&amp;gt; *
        required : bool *
        proof : (&#39;a -&amp;gt; string Option) list
    | Raw of
        value : &#39;a *
        message : string *
        proof : (&#39;a -&amp;gt; string Option) list
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Other F# validation libraries (that I know of).&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://fsharpforfunandprofit.com/posts/recipe-part2/&#34;&gt;http://fsharpforfunandprofit.com/posts/recipe-part2/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Swagger is too Restrictive</title>
      <link>http://localhost:1313/2016/07/10/swagger_is_too_restrictive/</link>
      <pubDate>Sun, 10 Jul 2016 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/07/10/swagger_is_too_restrictive/</guid>
      <description>&lt;p&gt;Swagger has a definite idea of what makes a good URL. But if you want to do
anything outside of that good luck. I think, that even though it seems like a
good idea to push people towards a standard it doesn&amp;rsquo;t allow the user to really
create RESTful APIs which suit their own needs.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s say that you have a reports resource. Sometimes you would like to get the
JSON data of the report. Sometimes you would like a partial static HTML page of
the report. Well, with RESTful APIs you could have something like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GET /api/reports/{id}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will get the data which you wanted. Now, what about the report? You could:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;GET reports/{id}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;But that seems like it would get you a full page, not a partial page. What if
you did this instead?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GET /api/reports/{id}
Content-Type text/html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The mapping of resources should be use all the available HTTP standards.
Swagger doesn&amp;rsquo;t allow for this. This is unfortunate.  The routes could have
been mapped something like this instead:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;paths:
  - url: /api/reports/{id}
    headers:
      - Content-Type: text/html
        response: ...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It appears that the standard might become more flexible in the future.  &lt;a href=&#34;https://github.com/OAI/OpenAPI-Specification/issues/146&#34;&gt;See
the issue on Github&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>JavaScript-Style Promises in F#</title>
      <link>http://localhost:1313/2016/06/26/js_style_promises_in_fsharp/</link>
      <pubDate>Sun, 26 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/06/26/js_style_promises_in_fsharp/</guid>
      <description>&lt;p&gt;Working in enterprise level back end software often times I need to get
information from many different sources. When you have enough of these sources
the time it takes to get all the information can really add up. That&amp;rsquo;s when F#
&lt;code&gt;async&lt;/code&gt; work flow really comes in handy. Except, there is a gotcha.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s say we have two sources we need to fetch data from:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;let myData () = async {
    let! a = myData1 ()
    let! b = myData2 ()
    let resultA = a
    let resultB = b
    // ... do stuff
    // return result
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So, when you look at that it looks like it should fetch the two data sources at
the same time. Well, it doesn&amp;rsquo;t. It does it one at a time, serially. It just
doesn&amp;rsquo;t block the thread while it is doing the fetching for each asynchronous
call.&lt;/p&gt;

&lt;p&gt;This is what you need to do to do it in parallel:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;let myData () = async {
    let! a = Async.StartChild &amp;lt;| myData1 ()
    let! b = Async.StartChild &amp;lt;| myData2 ()
    let! resultA = a
    let! resultB = b
    // ... do stuff
    // return result
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now it is doing it at the same time! To me this feels a bit unintuitive. Enter
JavaScript-style promises. Promise objects point to data and don&amp;rsquo;t execute
until you are ready to execute them as an &lt;code&gt;async&lt;/code&gt; function does in F#.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;let myData () =
    Q
    .all([myData1(), myData2()]) // Call two promises at the same time.
    .spread((resultA, resultB) =&amp;gt; {/* Do stuff here. */})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Could we do something like that in F#? We can mimic the process in F# by having
multiple functions depending on how many asynchronous processes you would like
to run at a time.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s say you would like to have two asynchronous functions run at once.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;module Async =
    let Spread2 a b =
        async {
            let! a = Async.StartChild a
            let! b = Async.StartChild b
            let! result1 = a
            let! result2 = b
            return result1, result2
        }
        |&amp;gt; Async.RunSynchronously
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Which would flow like so:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;let myData () =
    Async.Spread2 (myData1 ()) (myData2 ())
    |&amp;gt; fun (resultA, resultB) -&amp;gt; // Do stuff here.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Pretty close to what the JavaScript promise looked like. In my opinion this
work flow is much more intuitive and cleaner. It has a nicer flow than the
&lt;code&gt;async&lt;/code&gt; computation-style programming by not having to deal with the boiler
plate code. I could see having a few parallel functions all the way up to perhaps
&lt;code&gt;Async.Spread6&lt;/code&gt;. It would be very rare for me to ever need to call anything with
more external calls. Usually, I&amp;rsquo;m only calling two or three web services with the
rare five or six.&lt;/p&gt;

&lt;p&gt;A variation on the function above would be to add mapping functions to your parallel
function. I&amp;rsquo;m not sure if that would be useful in practice, but if it is I&amp;rsquo;ll be
adding it to mine.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;module Async =
    let Spread2With (a, f1) (b, f2) =
        async {
            let! a = Async.StartChild a
            let! b = Async.StartChild b
            let! result1 = a
            let! result2 = b
            return (f1 result1), (f2 result2)
        }
        |&amp;gt; Async.RunSynchronously
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I also debate whether it is smart to add the &lt;code&gt;Async.RunSynchronously&lt;/code&gt; at the end. If I didn&amp;rsquo;t have it I could use &lt;code&gt;Spread2&lt;/code&gt; to create &lt;code&gt;Spread4&lt;/code&gt; etc. If I ever needed more than six it might be worth it. But for now I haven&amp;rsquo;t run into that problem since I started using this pattern.&lt;/p&gt;

&lt;p&gt;Inspiration for this post:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://fsharpforfunandprofit.com/posts/recipe-part2/#comment-1508742658&#34;&gt;http://fsharpforfunandprofit.com/posts/recipe-part2/#comment-1508742658&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;http://stackoverflow.com/a/15829290/632495&#34;&gt;http://stackoverflow.com/a/15829290/632495&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Using NPM as a Build Tool</title>
      <link>http://localhost:1313/2016/06/21/npm_as_build_tool/</link>
      <pubDate>Tue, 21 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/06/21/npm_as_build_tool/</guid>
      <description>&lt;p&gt;I really like simplicity. The tools I use, I like them to make my life easy,
not hard. They need to work out of the box. No huge configuration settings,
just make it easy so I can get to work.&lt;/p&gt;

&lt;p&gt;Well, along come &lt;code&gt;grunt&lt;/code&gt;, &lt;code&gt;gulp&lt;/code&gt;, and now even more tools since I first started
writing this that I won&amp;rsquo;t mention. Two build tools for JavaScript. Wonderful,
we need tools to help us build our files. Wait a minute. We already have a
build tool, it&amp;rsquo;s called NPM. By the time I started learning JavaScript,
&lt;code&gt;gulp.js&lt;/code&gt; was the cool thing. I think &lt;code&gt;gulpl.js&lt;/code&gt; is a really nice tool. But, if
you are building simple apps or even complex apps you can get away with just
the command line and keep things simple and concise.&lt;/p&gt;

&lt;p&gt;So, if you really want to learn how to use NPM as your build tool there&amp;rsquo;s a
well written tutorial called &lt;a href=&#34;http://blog.keithcirkel.co.uk/how-to-use-npm-as-a-build-tool/&#34;&gt;How to Use npm as a Build
Tool&lt;/a&gt; which you
can read.&lt;/p&gt;

&lt;p&gt;So, some gripes people have about using NPM as a command tool are that you
can&amp;rsquo;t comment your scripts and that you can&amp;rsquo;t write variables. Well, enter
YAML. I haven&amp;rsquo;t done variables in YAML but you can write them. You can also
comment in YAML. You can even &lt;a href=&#34;http://unix.stackexchange.com/a/56449/89551&#34;&gt;write variables in your command
line&lt;/a&gt;. So, I write my scripts in
YAML and merge that into my &lt;code&gt;package.json&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s my scripts in YAML.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;# scripts run with npm. to build to package.json
# in command line in directory `.../mobiledlr/dist`
# `node ./tasks/buildPackage`
scripts:

  # bring together api.yml file with d.ts definitions
  # print to public
  api: |
    cpx &amp;quot;../ts/api/**&amp;quot; api
    &amp;amp;&amp;amp; node ./tasks/api-generator.js
  browserify: browserify
  deploy: node ./tasks/deploy.js

  # dsr app
  dsr: |
    browserify ./views/dealer_service_report/dsr.js
    | uglifyjs -m -c
    | tee ./public/js/dsr.min.js
    | ngzip
    &amp;gt; ./public/js/dsr.min.js.gz
  r: ramda
  start: node ./app.js --use_strict

  # Copy convert stylus files in directory to css
  # files in public directory.
  stylus: stylus -w -c ../static/stylus -o public/css
  test: node ./tasks/tests.js
  typescript: |
    tsc
    --isolatedModules
    -m commonjs
    -t es5
    --removeComments
    --sourceMap
    --outDir ./
    --rootDir ../ts

  watch: nodemon ./app.js --use_strict

  # this has been deprecated in preference for browserify
  webpack: |
    ./node_modules/.bin/webpack -w --cache --config ./config/webpack.config.js

  # e.g., npm run watchify ./dsr.js -o ./public/dsr.js
  watchify: watchify
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And here is the code I use to merge it with my &lt;code&gt;package.json&lt;/code&gt; file:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-typescript&#34;&gt;import r = require(&#39;ramda&#39;)
import yaml = require(&#39;js-yaml&#39;)
import {readFile, writeFile} from &#39;fs&#39;

var npmPackage = require(&#39;../package.json&#39;)

readFile(&#39;../scripts.yml&#39;, &#39;utf-8&#39;, (err, file) =&amp;gt; {
    if (err) {
        console.log(&#39;Error reading scripts.yml&#39;, err)
        return process.exit(1)
    }

    const
    scripts = yaml.load(file),
    combined = r.merge(npmPackage, scripts)

    writeFile(&#39;./package.json&#39;, JSON.stringify(combined, null, &#39;  &#39;).replace(/\\n/g, &#39; &#39;), err =&amp;gt; {
        if (err) {
            console.error(&#39;There was an error writing to package.json!&#39;, err)
            return process.exit(1)
        }
        process.exit(0)
    })
})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I put the scripts script in a directory called &lt;code&gt;tasks&lt;/code&gt; and just use the command
line &lt;code&gt;node ./tasks/scriptsPackage&lt;/code&gt; anytime I change my &lt;code&gt;scripts.yml&lt;/code&gt; file. I
suppose I could make it a CLI compatible command. But I haven&amp;rsquo;t needed to. But
I&amp;rsquo;m sure I would eventually want to. Once I do that I could add it to my
&lt;code&gt;scripts.yml&lt;/code&gt; file! Only the first time I call it would I need to call it
directly, so it would be something like this: &lt;code&gt;node
./.node_modules/.bin/scripts ../ts/scripts.yml&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>On-the-Fly Lambda Expressions in JavaScript</title>
      <link>http://localhost:1313/2016/06/13/lambda_expressions_in_javascript/</link>
      <pubDate>Mon, 13 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/06/13/lambda_expressions_in_javascript/</guid>
      <description>&lt;p&gt;Before many of the JavaScript compilers became real popular and if you wanted to write in straight JavaScript you could create functions on the fly. This was really nice for doing lambda functions.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s a couple libraries that did this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/fschaefer/Lambda.js&#34;&gt;https://github.com/fschaefer/Lambda.js&lt;/a&gt;
&lt;a href=&#34;https://github.com/dfellis/lambda-js&#34;&gt;https://github.com/dfellis/lambda-js&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s how it basically worked:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var f = function(func){
   var funcArray = func.split(&#39;-&amp;gt;&#39;)
   return   (funcArray.length === 1)
            ? new Function(&#39;x&#39;, &#39;return (&#39; + funcArray[0].trim() + &#39;)&#39;)
            : new Function(funcArray[0].trim(), &#39;return (&#39; + funcArray[1].trim() + &#39;)&#39;)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Pretty simple, but definitely not best practice now days.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Building a Convention Based Routes in Node.js</title>
      <link>http://localhost:1313/2016/06/07/building_convention_based_routes_in_nodejs/</link>
      <pubDate>Tue, 07 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/06/07/building_convention_based_routes_in_nodejs/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Convention_over_configuration&#34;&gt;Convention over
configuration&lt;/a&gt;
(also known as coding by convention) is a software design paradigm which
seeks to decrease the number of decisions that developers need to make,
gaining simplicity, and not necessarily losing flexibility.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It seems in programming, if we haven&amp;rsquo;t learned the basic practices of others,
we&amp;rsquo;ll end of repeating those practices; discovering them on our own. This isn&amp;rsquo;t
necessarily a bad thing. It can be a good way to learn. But at the same time,
we can learn faster just by learning from others first. I also like to think
about how a pattern or architecture could come about.&lt;/p&gt;

&lt;p&gt;Take for example the library &lt;a href=&#34;http://intercoolerjs.org/&#34;&gt;intercooler.js&lt;/a&gt;. You
can see where that library originated from. In HTML you can call a function
directly by adding an event to it. E.g.,&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;&amp;lt;div onclick=&amp;quot;clicked(this, &#39;my string I am passing&#39;)&amp;quot;&amp;gt;Click Me!&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So, intercooler.js took it the next step. They made it so you can create a
declarative HTML syntax. Similar to the code above, but an abstraction of that.
Now, I can see where &lt;a href=&#34;https://angularjs.org/&#34;&gt;angular.js&lt;/a&gt; came from (note, I&amp;rsquo;ve
never actually used angular.js). It just takes another abstraction layer up.&lt;/p&gt;

&lt;p&gt;Well, for convention of configuration. I came up with something for node.js,
but, after coming up with the idea I noticed that other people had come up with
similar ideas. In the end I liked mine more than theirs. But, many times we
think we are being original, but many of the ideas have probably existed for
the past thirty plus years.&lt;/p&gt;

&lt;p&gt;I went to a class at work where they were showing ASP.NET WebAPI. It is also
convention based and pretty much did the same thing I came up with, but more
powerful. I can understand why people don&amp;rsquo;t like convention over configuration
since you need to learn the conventions before you can understand the code,
since there is a certain amount of &amp;ldquo;magic&amp;rdquo;. But once you get past the magic it
becomes nice since you don&amp;rsquo;t need to write the same code over and over again.&lt;/p&gt;

&lt;p&gt;So, after that long introduction, here&amp;rsquo;s how I did convention based node.js.&lt;/p&gt;

&lt;p&gt;The file structure is like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root
  ┕ controllers
    ┝ people
    │ ┝ get-{id}.js
    │ ┕ get-{id}-animals.js
    ┕ animals
      ┝ get-{id}.js
      ┕ delete-{id}.js
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These directories/files would correspond to the routes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/api/people/{id} → Method: GET
/api/people/{id} → Method: GET
/api/animals/{id} → Method: GET
/api/animals/{id} → Method: DELETE
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you can see you could set up whatever combination you would like. I like
this method of convention also, since it keeps things simple. All your routes
are in your controller and easy to scan. So, when I need to edit a file I can
quickly find which one I&amp;rsquo;m looking for. Some of the other libraries nest the
routes in directories, which becomes very tedious.&lt;/p&gt;

&lt;p&gt;I use &lt;a href=&#34;http://swagger.io/&#34;&gt;swagger&lt;/a&gt; to map the route definitions to the route
methods. This way, I must have documentation in order to have a route. No
documentation, no route. But it also leaves me the flexibility to create routes
outside of this documentation if I really need to. But it just means it won&amp;rsquo;t
be set up in the normal way.&lt;/p&gt;

&lt;p&gt;So, in swagger (using YAML), the code would look like so:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;paths:

    /api/people/{id}:
      get:
        _call:
          - [params, id]

    /api/animals/{id}:
      delete:
        _call:
          - [params, id]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So, you can see how you can pass pretty much anything into your route method.
Each array element is passed into the method in the order given. The call takes
the parameters from the &lt;code&gt;request&lt;/code&gt; object that &lt;code&gt;express.js&lt;/code&gt; passes in. For more
complex items you can even pass in an object from different parts of the
&lt;code&gt;request&lt;/code&gt; object like so:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;_call:
  - userId: [params, id]
    userName: [user, username]
    guid: [user, guid]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Where &lt;code&gt;user&lt;/code&gt; comes from some middleware which validates the user authentication
information.&lt;/p&gt;

&lt;p&gt;This way of doing things also comes in handy since it means I can automate
integration tests. I can test each route in the &lt;code&gt;swagger&lt;/code&gt; file and make sure
that it is validated against the json-schema associated with that route.&lt;/p&gt;

&lt;p&gt;So, let&amp;rsquo;s look at the glue for all of this. I didn&amp;rsquo;t create an npm library for
this. I was thinking I would eventually, but since I just use WebAPI now, I
don&amp;rsquo;t want to support it. But, luckily the code is simple enough that that
isn&amp;rsquo;t a problem!&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ts&#34;&gt;import path = require(&#39;path&#39;)

module SwaggerRoutes {
    export interface Options {
        swagger: any
        baseRoute: any
        response: any
        baseDirectory: string
    }
    export interface CreateRoutes {
        (options: Options): void
    }
}

const
fail = reason =&amp;gt; {throw new Error(reason)},
type = o =&amp;gt; Object.prototype.toString.call(o),
isFunction = o =&amp;gt; type(o) === &#39;[object Function]&#39;,
isArray = o =&amp;gt; type(o) === &#39;[object Array]&#39;,
isObject = o =&amp;gt; type(o) === &#39;[object Object]&#39;,
getPropValue = (path, obj) =&amp;gt;
    path.reduce((acc, prop) =&amp;gt; acc === void 0 ? void 0 : acc[prop], obj),
args = (o, xs) =&amp;gt;
    xs.map(x =&amp;gt; (
        isArray(x)
            ? getPropValue(x, o)
        : isObject(x)
            ? (Object
                .keys(x)
                .reduce((acc, name) =&amp;gt;
                    (acc[name] = getPropValue(x[name], o), acc), {}))
        : void 0
    ))

const routePath = (route: string) =&amp;gt; {
    const
    components = route.slice(1).split(&#39;/&#39;),
    dir = components[0],
    baseFileName = components.slice(1).join(&#39;-&#39;)
    return [dir, baseFileName]
}

const expressCallback = (response, routeProperties, method, controller) =&amp;gt;
    (request, client, error) =&amp;gt; {

        const send = &amp;lt;any&amp;gt; response.bind(response, client)
        controller.apply(controller, args(request, routeProperties[method]._call))
        .then(send)
        .catch(error)

    }

const createRoutes: SwaggerRoutes.CreateRoutes = (o: SwaggerRoutes.Options) =&amp;gt; {
    const paths = o.swagger.paths
    Object.keys(paths)
    .filter(x =&amp;gt; x.charAt(0) === &#39;/&#39;)
    .forEach(routeName =&amp;gt; {

        const
        routeProperties = paths[routeName],
        basePath = routePath(routeName)

        Object.keys(routeProperties)
        .forEach(method =&amp;gt; {
            if (routeProperties[method]._call) {
                const
                requirePath = path.resolve(
                    __dirname,
                    path.join(
                        o.baseDirectory,
                        basePath[0],
                        (basePath[1] ? `${method}-${basePath[1]}` : method))),
                handler = require(requirePath),
                controller =
                    isFunction(handler)
                        ? handler
                    : isFunction(handler.default)
                        ? handler.default
                    : fail(&#39;Could not retrieve `handler` function.&#39;)

                const
                routePath = routeName.replace(/{(\w+)}/g, &#39;:$1&#39;),
                altPath =
                    (routeProperties[method].parameters || [])
                    .reduce((acc, x) =&amp;gt;
                        x.required ? acc : acc.replace(RegExp(`/:${x.name}`), &#39;&#39;), routePath),
                routePaths = altPath !== routePath ? [altPath, routePath] : [routePath]

                routePaths.forEach(x =&amp;gt; {
                    o.baseRoute(x)
                    [method](expressCallback(o.response, routeProperties, method, controller))
                })

            }
        })

    })
}

export = createRoutes
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here&amp;rsquo;s how you would call that code to set up your routes:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ts&#34;&gt;import swaggerRoutes = require(&#39;./swagger-routes&#39;)
const yaml = require(&#39;js-yaml&#39;)

swaggerRoutes({
    swagger: yaml.load(readFileSync(&#39;./api/api.yml&#39;, &#39;utf-8&#39;)),
    baseRoute: authenticatedRoute,
    response: (client: express.Response, result) =&amp;gt;
        client.send(omit([&#39;httpStatusCode&#39;], withMessageAs(result))),
    baseDirectory: &#39;../controllers&#39;
})
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>CSS Media Object</title>
      <link>http://localhost:1313/2014/12/30/css_media_object/</link>
      <pubDate>Tue, 30 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2014/12/30/css_media_object/</guid>
      <description>&lt;p&gt;I just finished attending the RockIt Bootcamp (12 week program). It&amp;rsquo;s a program that teaches the LAMP full stack development (Linux, Apache, mySQL, PHP). In the next little while I will be going over some of the things which I learned.&lt;/p&gt;

&lt;p&gt;The &lt;em&gt;css media object&lt;/em&gt; was first coined by &lt;a href=&#34;http://www.stubbornella.org/content/2010/06/25/the-media-object-saves-hundreds-of-lines-of-code/&#34;&gt;Nicole Sullivan&lt;/a&gt; in 2010. It is still one of the most basic constructs to learn and understand in created good CSS content.&lt;/p&gt;

&lt;p&gt;The &lt;em&gt;media object&lt;/em&gt; is basically a box with two other boxes side by side in the main box. Typically the box to the left is a picture and the box to the right is content, but can be anything.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-html&#34;&gt;&amp;lt;div class=&amp;quot;media&amp;quot;&amp;gt;
  &amp;lt;img src=&amp;quot;/images/my-cool-mug.png&amp;quot; alt=&amp;quot;A pic of me&amp;quot;&amp;gt;
  &amp;lt;div&amp;gt;
    &amp;lt;p&amp;gt;Some written content in the media object.&amp;lt;/p&amp;gt;
    &amp;lt;p&amp;gt;Look, another paragraph in the media object!&amp;lt;/p&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;em&gt;media object&lt;/em&gt; css gives padding and margins to the objects that make them look nice and make the picture fit correctly. It also does a clearfix so the outside box doesn&amp;rsquo;t collapse to a smaller area than its content.&lt;/p&gt;

&lt;p&gt;Some of the code I made specifically for this example, but in practice you would not put everything in the &lt;code&gt;media&lt;/code&gt; class. E.g., the &lt;code&gt;width&lt;/code&gt; of the media element would be decided somewhere else, make the &lt;code&gt;media&lt;/code&gt; class more reusable.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-css&#34;&gt;/* Give the media object a shape. Add */
/* padding just to make it look nice. */
.media {
  padding: 10px;
  width: 300px;
}
/* clearfix */
.media::after {
  content: &#39;&#39;;
  display: block;
  clear: both;
}
.media &amp;gt; * {
  padding: 0;
  margin: 0;
}
.media &amp;gt; *:first-child {
  float: left;
}
/* Make all content be past the picture. */
.media &amp;gt; *:last-child {
  margin-left: 110px;
}
/* The following is just to make */
/* the paragraphs look nice. */
.media &amp;gt; *:last-child &amp;gt; * {
  margin: 0 0 10px 0;
}
.media &amp;gt; *:last-child &amp;gt; *:last-child {
  margin-bottom: 0;
}
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Angular.js vs React.js vs Mithril.js</title>
      <link>http://localhost:1313/2014/10/03/angular_vs_react_mithril/</link>
      <pubDate>Fri, 03 Oct 2014 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2014/10/03/angular_vs_react_mithril/</guid>
      <description>&lt;p&gt;Apparently Facebook has a bunch of functional-style programmers, not writing in ClosureScript though! &lt;a href=&#34;https://www.youtube.com/watch?v=IVvHPPcl2TM&#34;&gt;https://www.youtube.com/watch?v=IVvHPPcl2TM&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://youtu.be/nYkdrAPrdcw?t=40m30s&#34;&gt;http://youtu.be/nYkdrAPrdcw?t=40m30s&lt;/a&gt;
&amp;gt; [Starts at 40 minute 30 seconds. Person asks question then Jing Chen
&amp;gt; laughs at question, she must know how much Pete doesn&amp;rsquo;t like Angular.]
&amp;gt; So, the question was comparing and contrasting&amp;hellip;React plus Flux and
&amp;gt; Angular. &amp;hellip;[T]hey do solve some of the same
&amp;gt; problems but they go at it in very different ways. So React is focused a
&amp;gt; lot on treating your code as a black box. So, there&amp;rsquo;s no sort of
&amp;gt; observable abstraction inside of react you simply say, &amp;ldquo;Hey, rerender
&amp;gt; the UI and you present a consistent view of what you want your UI to
&amp;gt; look like.&amp;rdquo; With Angular you are basically passing data throughout these
&amp;gt; things called scopes which observe your data model and I think&amp;hellip;
&amp;gt; that&amp;rsquo;s a very leaky abstraction. It forces you to compose your
&amp;gt; application not in terms of functions and objects but in terms of
&amp;gt; directives and model-view-controller and their flavor of
&amp;gt; model-view-controller. So, while it does work for a certain class of
&amp;gt; applications as you scale up you start to miss the past 40 or 50 years
&amp;gt; of research and how to abstract a program. So if you&amp;hellip;
&amp;gt; push that kind of data binding concern out to the edges of your
&amp;gt; system like React does I think it leads to faster iteration time.\
&amp;gt; &amp;ndash; &lt;em&gt;Pete
&amp;gt; Hunt - Engineering Manager, Rethinking Web App Development at Facebook,
&amp;gt; Facebook&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Leo Horie (creator of Mithril on Flux/React)
&lt;a href=&#34;https://news.ycombinator.com/item?id=7720559&#34;&gt;https://news.ycombinator.com/item?id=7720559&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I really like this architecture - it&amp;rsquo;s clearly based on lessons learned
from the same types of pains that I myself encountered w/ non-trivial
jQuery, and the unidirectional data flow makes it a lot easier to reason
about the code. It&amp;rsquo;s very similar to what I&amp;rsquo;m doing with my own micro
mvc framework Mithril ( &lt;a href=&#34;http://lhorie.github.io/mithril&#34;&gt;http://lhorie.github.io/mithril&lt;/a&gt; ).&lt;/p&gt;

&lt;p&gt;One thing that raise my eyebrows about this article though is how says
that Flux eschews MVC, and then goes on to say that it has stores that
are &amp;ldquo;somewhat similar to a model&amp;rdquo;, and &amp;ldquo;the dispatcher exposes a method
that allows a view to trigger a dispatch to the stores&amp;rdquo;, which, as far
as classic MVC goes, is the exact definition of a controller. What they
call controller-view is, imho, just an implementation detail within the
view layer: in classic MVC, views were responsible for subscribing to
model observables, or, as the article puts it, it &amp;ldquo;listens for events
that are broadcast by the stores that it depends on&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;When talking about this architecture with the Mithril community, I find
that referring back to the MVC pattern makes it even easier to reason
about the flow of data: it&amp;rsquo;s basically M -&amp;gt; V -&amp;gt; C -&amp;gt; M &amp;hellip;&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s unfortunate that the general understanding of the MVC pattern
became misunderstood over the course of many frameworks. The whole point
of design patterns should be that we could just name them for people to
&amp;ldquo;get&amp;rdquo; it, rather than having to reinvent new ways of naming things and
having everyone relearn the nomenclature.&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>bilby.js &amp; lenses</title>
      <link>http://localhost:1313/2014/07/01/bilbyjs_lenses/</link>
      <pubDate>Tue, 01 Jul 2014 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2014/07/01/bilbyjs_lenses/</guid>
      <description>&lt;p&gt;In JavaScript nearly everything is &lt;a href=&#34;http://en.wikipedia.org/wiki/Mutable&#34;&gt;mutable&lt;/a&gt;. This can cause problems
in your code when you think you have a new object or variable but
instead you are operating on the referenced object. So, we create
patterns to alleviate this problem. Or we use libraries like
&lt;a href=&#34;http://underscorejs.org/&#34;&gt;underscore.js&lt;/a&gt; or &lt;a href=&#34;http://lodash.com/docs&#34;&gt;lodash.js&lt;/a&gt; which incorporate the functional
concepts. Unfortunately they don&amp;rsquo;t always use immutable objects either.&lt;/p&gt;

&lt;p&gt;Bilby.js solves the mutability problem by using &lt;a href=&#34;http://bilby.brianmckenna.org/#lenses&#34;&gt;lenses&lt;/a&gt;. Using the
&lt;a href=&#34;http://en.wikipedia.org/wiki/Bidirectional_transformation&#34;&gt;lenses&lt;/a&gt; pattern one can access and change one&amp;rsquo;s objects in a safe
and immutable manner.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s say we have the &lt;code&gt;Person&lt;/code&gt; object.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;function Person(){
   this.name = {first: &#39;George&#39;, last: &#39;Stanza&#39;}
   this.id = 0
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We use bilby.js lenses by first creating lens objects.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var nameLens = bilby.objectLens(&#39;name&#39;)
var firstLens = bilby.objectLens(&#39;first&#39;)
var lastLens = bilby.objectLens(&#39;last&#39;)
var idLens = bilby.objectLens(&#39;id&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We then can use getters to access the data.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var george = new Person()
// Person {name: {first:&#39;George&#39;, last: &#39;Stanza&#39;}, id: 0}
firstLens.compose(nameLens).run(george).getter
//George
lastLens.compose(nameLens).run(george).getter
//Stanza
idLens.run(george).getter
//0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or you can create a get function.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var get = function(lens, obj){
   return lens.run(obj).getter
}
// e.g.,
get(firstLens.compose(nameLens), george)
// George
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To create a new object with new values from another object.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var susan = firstLens.compose(nameLens).run(george).setter(&#39;Susan&#39;)
// Object {name: {first:&#39;Susan&#39;, last: &#39;Stanza&#39;}, id: 0}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The below code is strongly discouraged by &lt;a href=&#34;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf&#34;&gt;Mozilla Developer Network&lt;/a&gt;.
Also, the correct method would be &lt;code&gt;Object.getPrototypeOf(object)&lt;/code&gt; and
&lt;code&gt;Object.setPrototypeOf(object)&lt;/code&gt; instead of &lt;code&gt;__proto__&lt;/code&gt;. I&amp;rsquo;ve since
switched to using plain objects with commonjs modules instead.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;End Update&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Hhhhmmm&amp;hellip;there&amp;rsquo;s a problem there. &lt;code&gt;susan&lt;/code&gt; is no longer a &lt;code&gt;Person&lt;/code&gt; she&amp;rsquo;s
only an &lt;code&gt;Object&lt;/code&gt;. We don&amp;rsquo;t want to objectify her do we? I worked around
this problem by creating my own &lt;code&gt;set&lt;/code&gt; function.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var set = function(lens, object, value){
   var newObject = lens.run(object).setter(value)
   return _.isEqual(newObject.__proto__, object.__proto__) 
      ? newObject 
      : (newObject.__proto__ = object.__proto__, newObject)
}
//e.g.,
var fred = set(firstLens.compose(nameLens), george, &#39;Fred&#39;)
// Person {name: {first:&#39;Fred&#39;, last: &#39;Stanza&#39;}, id: 0}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now we need to remember that these new objects are not deep clones, only
shallow clones, which helps with performance but, if we leave our design
pattern we could get in trouble, so be careful!&lt;/p&gt;

&lt;p&gt;Note that in &lt;a href=&#34;https://github.com/fantasyland/fantasy-lenses&#34;&gt;Fantasy Land lenses&lt;/a&gt; the naming convetion is different
&lt;code&gt;setter&lt;/code&gt; and &lt;code&gt;getter&lt;/code&gt; drop the &lt;code&gt;ter&lt;/code&gt; and &lt;code&gt;compose&lt;/code&gt; is dropped in favor
of &lt;code&gt;andThen&lt;/code&gt; making it so you can switch the order of your lenses.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var deborah = nameLens.andThen(firstLens).run(george).set(&#39;Deborah&#39;)
// Object {name: {first: &#39;Deborah&#39;, last: &#39;Stanza&#39;}, id: 0}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you want to play around with these concepts in jsFiddle you can use lodash.js&amp;rsquo; &lt;code&gt;_.assign&lt;/code&gt; method. I&amp;rsquo;ve set up the &lt;a href=&#34;http://jsfiddle.net/jon49/3xRNT/&#34;&gt;jsFiddle here.&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Match Expression for JavaScript?</title>
      <link>http://localhost:1313/2014/06/20/match_expression_javascript/</link>
      <pubDate>Fri, 20 Jun 2014 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2014/06/20/match_expression_javascript/</guid>
      <description>&lt;p&gt;Sometimes (or rather most of the time) it would be nice to have more concise code in JavaScript. I was working with a function that needed quite a bit of &lt;code&gt;if&lt;/code&gt; statements. &lt;code&gt;if&lt;/code&gt; was awfully cluttered. I had looked at &lt;a href=&#34;http://bilby.brianmckenna.org/examples/validation.htm&#34;&gt;bilby.js examples&lt;/a&gt; and hadn&amp;rsquo;t realized that you can do multiple &lt;code&gt;ternary expressions&lt;/code&gt; in a row.&lt;/p&gt;

&lt;p&gt;So, instead of,&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;if (0){
  return 0
}
else if (1){
   if (2) {
     return 1
   }
   else if (3) {
     return 2
   }
   else {
     return 3
   }
}
else {
  return 4
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can do,&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;(0) ? 0
: (1) ?
     (2) ? 1
   : (3) ? 2
   : 3
: 4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Which is much more concise and readable.&lt;/p&gt;

&lt;p&gt;So where does &lt;code&gt;match expressions&lt;/code&gt; come into play? Glad you asked.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;ternary&lt;/code&gt; example above gives a similar &lt;a href=&#34;http://fsharpforfunandprofit.com/posts/match-expression/&#34;&gt;feel to &lt;code&gt;F#&lt;/code&gt;&amp;rsquo;s &lt;code&gt;match expressions&lt;/code&gt;&lt;/a&gt;. So, as an example here&amp;rsquo;s what a similary structured &lt;code&gt;match expression&lt;/code&gt; would look like.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-fsharp&#34;&gt;match [something] with 
| pattern0 -&amp;gt; 0
| pattern1 -&amp;gt; 
   match [something else] with
   | pattern2 -&amp;gt; 1
   | pattern3 -&amp;gt; 2
   | _ -&amp;gt; 3
| _ -&amp;gt; 4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Of course, with &lt;code&gt;F#&lt;/code&gt; you could probably get away  without doing the second &lt;code&gt;match&lt;/code&gt; by using a &lt;code&gt;Tuple&lt;/code&gt; but that is beyond the scope of this post.&lt;/p&gt;

&lt;p&gt;So, let&amp;rsquo;s look at the real function I made. First, let&amp;rsquo;s set up the bare parts of the function.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var addRollingArray = function (array, start, end, fraction) {
  var floor = Math.floor
  // Put code below here.
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then we&amp;rsquo;ll map the array with some helper logic values.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;  return _.map(array, function (value, index) {
    var isIndexStart = (floor(start) === index),
        isIndexBetween = (floor(start) &amp;lt;= index &amp;amp;&amp;amp; index &amp;lt;= floor(end)),
        isIndexEnd = (floor(end) === index)
    // Code below goes here.
  })
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here&amp;rsquo;s the &lt;code&gt;if&lt;/code&gt; code,&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;if (isIndexBetween) {
  if (isIndexStart &amp;amp;&amp;amp; isIndexEnd)
    return fraction * (end - start) + value
  else if (isIndexStart)
    return fraction * (1 + index - start) + value
  else if (isIndexEnd)
    return fraction * (end - index) + value
  else
    // Index is fully between start and end values
    return fraction + value
}
// Index is out of bounds return original value
return value
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And here&amp;rsquo;s the refactored code,&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;return   
  isIndexBetween ? 
      isIndexStart &amp;amp;&amp;amp; isIndexEnd ? fraction * (end - start) + value
    : isIndexStart ? fraction * (1 + index - start) + value
    : isIndexEnd   ? fraction * (end - index) + value
    // Index is fully between start and end values
    : fraction + value
  // Index is out of bounds return original value
  : value
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>A Distributed &amp; Robust Feedly</title>
      <link>http://localhost:1313/2014/06/12/distributed_robust_feedly/</link>
      <pubDate>Thu, 12 Jun 2014 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2014/06/12/distributed_robust_feedly/</guid>
      <description>&lt;p&gt;In light of the recent attack on &lt;a href=&#34;http://feedly.com/&#34;&gt;Feedly.com&lt;/a&gt; I thought it might be interesting to see other ways we could propogate data accross the Interent without being succeptible to attacks, or, at least less accessible.&lt;/p&gt;

&lt;p&gt;With the approach outlined below we need to use an actual app instead of being able to use a browser (there might be a way to use a browser also, not sure how it would work though).&lt;/p&gt;

&lt;p&gt;I used BitTorrent Sync as the distribution model. The more people that follow a blog the more robust its feed will become.&lt;/p&gt;

&lt;p&gt;On the back end all feedly would need to do is periodically update the feeds and user data - but the user data will only need to be updated if a user changes their password. If they have a read-write key for their data then it can be updated only locally and then propogated. The more devices a user uses the more robust their data will become.&lt;/p&gt;

&lt;p&gt;It will be nice when the internet will catch up with the distributed model of doing things.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://localhost:1313/images/FeedlyApp.png&#34;&gt;&lt;img src=&#34;http://localhost:1313/images/small/FeedlyApp.png&#34; alt=&#34;A Simple Outline of How to Set Up a Distributed Feedly&#34; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;A Simple Outline of How to Set Up a Distributed Feedly&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>JavaScript</title>
      <link>http://localhost:1313/2014/06/07/javascript/</link>
      <pubDate>Sat, 07 Jun 2014 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/2014/06/07/javascript/</guid>
      <description>&lt;p&gt;I’ve jumped ship from Excel programming over to JavaScript (in a
functional manner). I’ve also gone the way of Linux away from Windows. I
love Excel and its power. But I see the writing on the wall and am
moving to where I can hopefully get some work and starting making some
moolah. You can follow my new blog over at
&lt;a href=&#34;http://thisisafiller.ghoster.io/&#34;&gt;http://thisisafiller.ghoster.io/&lt;/a&gt;.\
 If anyone is interested in the products I’ve made let me know how you
like them and &lt;a href=&#34;http://nymanjon@gmail.com&#34;&gt;send me an e-mail&lt;/a&gt;. Or tweet
me &lt;a href=&#34;https://twitter.com/NymanJon&#34;&gt;@NymanJon&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>